# Текст выступления на защите ВКР

**Тема:** Алгоритм предиктивного анализа отказов системы видеоаналитики в режиме реального времени по данным от систем мониторинга

---

## Слайд 1: Титульный лист

**Здравствуйте, уважаемые члены аттестационной комиссии!**

Меня зовут **Боровец Николай Васильевич**, и я представляю вашему вниманию выпускную квалификационную работу на тему: «Алгоритм предиктивного анализа отказов системы видеоаналитики в режиме реального времени по данным от систем мониторинга».

Вся представленная работа, от анализа данных и инженерии признаков до реализации и сравнения моделей, была выполнена мной самостоятельно. От научного руководителя я получил исходные данные в виде дампа из промышленной системы мониторинга Prometheus и ценные теоретические консультации.

---

## Слайд 2: План доклада

В ходе доклада будут рассмотрены следующие ключевые этапы работы:
1.  **Введение:** Актуальность, цель и задачи исследования.
2.  **Постановка задачи и анализ данных:** Описание архитектуры системы и ключевые выводы по данным.
3.  **Методология:** Подходы к инженерии признаков, выбору моделей и валидации.
4.  **Результаты:** Сравнительный анализ моделей и выбор лучшей.
5.  **Заключение:** Основные итоги и выводы по работе.
6.  **Дальнейшее развитие:** Перспективы и направления для будущих исследований.

---

## Слайд 3: Цель и задачи

**Цель работы:** разработать и внедрить комплексный метод предиктивного анализа задержек в конвейере видеоаналитики, способный прогнозировать конечную метрику с заданной точностью для предупреждения операторов о потенциальных сбоях до их фактического проявления.

**Задачи:**
1.  Провести аналитический обзор литературы по предиктивному анализу временных рядов.
2.  Выполнить анализ структуры и взаимных корреляций данных, собранных с промышленной системы, для выявления наиболее информативных признаков.
3.  Провести сравнительный анализ современных методов прогнозирования: классических, машинного обучения и глубоких нейронных сетей.
4.  Обосновать выбор и реализовать три ключевые модели, определить оптимальные стратегии инженерии признаков для каждой.
5.  Спроектировать и реализовать MLOps-конвейер для автоматизации экспериментов и обеспечения их воспроизводимости.
6.  Провести всестороннее экспериментальное исследование точности и производительности разработанных моделей.
7.  Сформулировать практические рекомендации по эксплуатации и настройке решения в производственной среде.

---

## Слайд 4: Актуальность

**Актуальность** работы обусловлена ростом сложности современных систем видеоаналитики. Традиционные методы мониторинга, зачастую основанные на статических алертах в Grafana, реагируют на сбои уже постфактум, что недопустимо для критической инфраструктуры. Переход к предиктивному анализу позволяет заблаговременно выявлять потенциальные проблемы и предотвращать деградацию качества обслуживания.

---

## Слайд 5: Архитектура системы

**Объектом исследования** является многокомпонентный конвейер видеоаналитики, включающий модули захвата видео, ML-обработку, брокер сообщений Kafka и backend-сервисы. Стоит отметить, что в рамках работы в лаборатории Передовой инженерной школы радиолокации, радионавигации и программной инженерии (ПИШ РПИ) я также принимал непосредственное участие в разработке компонентов бэкенд-сервисов данного конвейера.

На схеме представлена архитектура системы и точки сбора ключевых метрик.

**(Здесь на слайде должен быть Рисунок 1.1 из диплома)**

---

## Слайд 6: Постановка задачи

Для решения задачи были сформулированы следующие формальные требования.

**Дано:**
*   Многомерный временной ряд системных метрик за 16 дней с интервалом 15 секунд.
*   Целевая метрика — сквозная задержка обработки события ($common\_event\_delay$).

**Требуется найти** прогностический алгоритм, который по истории наблюдений предсказывает значение целевой метрики на **горизонте 3.75 часа** со средней ошибкой **менее 10%**.

---

## Слайд 7: Анализ данных 1

В ходе анализа данных были выявлены ключевые характеристики временных рядов:
*   **Корреляция:** Наибольшую связь с целевой метрикой показала задержка в брокере сообщений Kafka (коэффициент корреляции +0.58).
*   **Структура ряда:** Сезонная декомпозиция выявила доминирующую **суточную сезонность** и нелинейный тренд.

**(Здесь на слайде должны быть ключевые графики из Главы 2, например, Рисунок 2.4 и 2.5)**

---

## Слайд 8: Анализ данных 2

*   **Автокорреляция:** Анализ автокорреляционных функций (ACF и PACF). Медленно затухающая ACF — это классический признак **нестационарности** ряда. В то же время PACF показывает не только сильную зависимость от предыдущего значения, но и значимые пики на лагах 60, 120 и 180. Это прямо указывает на **сезонную зависимость** с периодом 60. Становится ясно, что необходим подход, который умеет работать и с нестационарностью, и с сезонностью, что и привело нас к модели SARIMA.

**(Здесь на слайде должны быть ключевые графики из Главы 2, например, Рисунок 2.6)**

---


## Слайд 9: Методология и модели

Для решения задачи был применен комплексный подход:
1.  **Инженерия признаков:** Сгенерированы календарные, циклические, лаговые и статистические признаки на основе скользящих окон.
2.  **Выбор моделей:** Для сравнения были выбраны три модели, представляющие разные подходы:
    *   **SARIMA:** классическая статистическая модель, хорошо подходящая для данных с явным трендом и сезонностью, выявленными на этапе анализа.
    *   **CatBoost:** градиентный бустинг над деревьями решений. В работе использовался гибридный подход, где тренд моделировался отдельно, а CatBoost прогнозировал сезонную компоненту и остатки.
    *   **LSTM:** рекуррентная нейронная сеть, специально разработанная для улавливания сложных долгосрочных зависимостей в последовательных данных, что идеально подходит для нашей задачи.
    *   Для полноты исследования был проведен ряд дополнительных экспериментов с широким спектром современных архитектур. Мы протестировали модели **N-BEATS**, а также большой ансамбль из библиотеки **Time-Series-Library**, включая **DLinear, PatchTST, iTransformer, Crossformer, NLinear, Autoformer** и другие. Дополнительно были оценены подходы автоматического машинного обучения из библиотеки **AutoTS**. Несмотря на их потенциал, в рамках нашей задачи они не показали стабильных и конкурентоспособных результатов, что может быть связано с необходимостью их глубокой адаптации. Это позволило нам сфокусироваться на детальном сравнении SARIMA, CatBoost и LSTM.
3.  **Валидация и предотвращение утечек данных:** Этот пункт оказался критически важным. Первоначальные эксперименты привели к **утечке данных** из-за некорректной генерации признаков до разделения на train/test. Проблема была решена **комплексным подходом**: строгим разделением данных с помощью `TimeSeriesSplit` **и** корректной генерацией всех признаков исключительно на обучающих данных для каждого фолда. Этот опыт подчеркнул, что правильная валидация — это не только выбор метода, но и соблюдение всей последовательности операций.

---

## Слайд 10: Результаты экспериментов

Все модели показали значительное превосходство над наивным прогнозом. В таблице представлены усредненные результаты лучших конфигураций по итогам кросс-валидации.

| Модель                      | MAE   | RMSE  | MAPE, \%  |
| --------------------------- | ----- | ----- | --------- |
| Наивный прогноз (Baseline)  | 121.5 | 153.2 | 31.52     |
| **SARIMA**                  | 44.1  | 51.4  | 11.06     |
| **CatBoost**                | 36.0  | 41.1  | 8.90      |
| **LSTM**                    | **3.7**   | **4.5**   | **0.89**      |

**Модели LSTM и CatBoost выполнили техническое требование по точности (MAPE < 10%). Модель SARIMA не удовлетворила этому требованию.**

---

## Слайд 11: Анализ и сравнение результатов

Визуальный анализ прогнозов подтверждает выводы, полученные на основе метрик.

**(Здесь на слайде должны быть графики прогнозов, особенно Рисунок 4.3 для LSTM)**

*   **LSTM** продемонстрировала наилучший результат, с ошибкой MAPE всего 0.89%. Она точно улавливает как общие тренды, так и локальные колебания.
*   **CatBoost** также показала хороший результат (MAPE 8.90%), став компромиссом между качеством и сложностью реализации.
*   **SARIMA** оказалась неспособна справиться со сложной нелинейной динамикой процесса.

Высокая точность LSTM объясняется ее способностью эффективно работать с долгосрочными зависимостями и многомерными признаками.

---

## Слайд 12: Заключение

**Цель работы достигнута:** разработан метод предиктивного анализа задержек, позволяющий прогнозировать состояние видеоконвейера на 3.75 часа вперед.

**Основные результаты по задачам:**
1.  **Проведен обзор литературы**, что сформировало теоретическую базу исследования.
2.  **Выполнен всесторонний анализ данных**, в результате которого выявлена суточная сезонность и определены ключевые влияющие признаки.
3.  **Проведен сравнительный анализ моделей**, который показал перспективность подходов на основе машинного и глубокого обучения для данной задачи.
4.  **Реализованы три модели** (SARIMA, CatBoost, LSTM) с индивидуальными стратегиями инженерии признаков.
5.  **Разработана и реализована методология MLOps**, которая автоматизировала эксперименты, обеспечив их корректность и воспроизводимость.
6.  **Проведено экспериментальное исследование**, в ходе которого модель LSTM показала наивысшую точность (MAPE 0.89%), а также была выявлена и устранена проблема утечки данных.
7.  **Сформулированы практические рекомендации** по выбору и внедрению оптимальной модели в зависимости от требований.

---

## Слайд 13: Дальнейшее развитие работы

Проделанная работа открывает несколько векторов для дальнейшего развития:

1.  **От предсказания к диагностике:** Следующим шагом является переход от вопроса *"что случится?"* к вопросу *"почему это случится?"*. Этого можно достичь, внедрив модели интерпретируемости, такие как SHAP, для объяснения прогнозов LSTM, а также разработав классификатор для определения корневой причины (Root Cause Analysis) аномалий.

2.  **Полноценное MLOps-внедрение:** Развитие созданного прототипа в полноценную production-систему, включающую мониторинг дрейфа данных и концепта, а также CI/CT/CD пайплайны для непрерывного обучения и развертывания моделей.

3.  **Переход к проактивному управлению:** Использовать прогнозы не только для алертинга, но и для автоматического управления ресурсами. Например, система могла бы самостоятельно масштабировать компоненты конвейера в зависимости от прогнозируемой нагрузки, переходя от пассивного мониторинга к проактивному менеджменту.

---

## Слайд 14: Спасибо за внимание!

**Готов ответить на ваши вопросы.** 